\documentclass[latex/main.tex]{subfiles}

\begin{document}
\section{Appendix}

\subsection{Delta method}

The standard errors of the timescale parameter is a function of the autocorrelation coefficient $\phi_1$ of an AR(1) process.

The AR(1) process is defined as:  

$X_t = \phi_1 X_{t-1} + \epsilon_t$

where $\epsilon_t \sim \mathcal{N}(0, \sigma^2)$.

The theoretical autocorrelation function (ACF) of the AR(1) process is:

$\rho_\tau = \phi_1^\tau$

where $\rho_\tau$ is the autocorrelation at lag $\tau$.

...

The \textit{timescale} is defined as the number of lags it takes the ACF to reach $\frac{1}{e}$, which is equivalent to finding the value of $\tau$ that satisfies the equation:

$\phi_1^\tau = \frac{1}{e}$

$\tau \cdot log(\phi_1) = log(\frac{1}{e}) = -1$

$\tau = - \frac{1}{log(\phi_1)}$.

...

To apply the delta method, we express the timescale $\tau$ as a function of the AR(1) coefficient $\phi_1$:

$g(\phi_1) = \frac{-1}{log(\phi_1)}$

$g'(\phi_1) = \frac{1}{\phi_1 log(\phi_1)^2}$.

Then estimate the standard error of the estimated timescale parameter:

$\hat{\sigma}_\tau = g'(\hat{\phi_1}) \cdot \hat{\sigma}_{\phi_1}$

where $\hat{\phi_1}$ is the estimate of the AR(1) coefficient and $\hat{\sigma}_{\phi_1}$ is its estimated standard error.

\subsection{Stationarity of AR(2) process}

\href{https://stats.stackexchange.com/questions/118019/a-proof-for-the-stationarity-of-an-ar2}{StackExchange}

An AR(2) process is stable if the following three conditions are met:
1. $\phi_2 < 1 + \phi_1$
2. $\phi_2 < 1 - \phi_1$
3. $\phi_2 > -1$

\subsection{Spectrum of AR(2) process}

\href{https://en.wikipedia.org/wiki/Autoregressive_model#Spectrum}{Wikipedia}

PSD of AR(p) process with noise variance $Var(X_t) = \sigma^2_{X_t}$ is

\begin{align*}
S(f) = \frac{\sigma^2_X}{|1 - \sum_{k=1}^p \phi_k e^{-i2\pi fk}|^2}
\end{align*}

For AR(2)

\begin{align*}
S(f) = \frac{\sigma^2_X}{1 + \phi_1^2 + \phi_2^2 - 2\phi_1(1 - \phi_2)\cos(2\pi f) - 2\phi_2\cos(4\pi f)}
\end{align*}

\subsection{Optimization functions}

NLS:

$\min_{\tau} \int \left[ \rho(t) - e^{-\frac{t}{\tau}} \right]^2 \, dt$  

where $\rho(t)$ is the autocorrelation function (ACF) and $e^{-\frac{t}{\tau}}$ represents an exponential function with a decay rate determined by the parameter $\tau$.

First differentiate the objective function with respect to $\tau$:  

$\frac{d}{d\tau} \left[ \rho(t) - e^{-\frac{t}{\tau}} \right]^2 = - \frac{2 \left[\rho{\left(t \right)} - e^{- \frac{t}{\tau}}\right] e^{- \frac{t}{\tau}}}{\tau^{2}}$  

Next, integrate the derivative expression with respect to $t$:  

$\frac{d}{d\tau} \int \left[ \rho(t) - e^{-\frac{t}{\tau}} \right]^2 \, dt = - \frac{2 \left[\int \left(- e^{- \frac{2 t}{\tau}}\right)\, dt + \int \rho{\left(t \right)} e^{- \frac{t}{\tau}}\, dt\right]}{\tau^{2}}$

?? Can this be solved numerically ??

...

OLS:

$x_t = \phi_1 x_{t-1} + \phi_2 x_{t-2} + \epsilon$  
$\min_{\phi} \mathbb{E} \left[ x_t - \phi x_{t-1} \right]^2$  
$\frac{d}{d\phi} = $

...

Expand the objective function:

$\mathbb{E} \left[ x_t - \phi x_{t-1} \right]^2 = \mathbb{E} \left[ (x_t - \phi x_{t-1})^2 \right]$

Substitute in AR(2) model:

$\mathbb{E} \left[ (x_t - \phi x_{t-1})^2 \right] = \mathbb{E} \left[ (\phi_1 x_{t-1} + \phi_2 x_{t-2} + \epsilon - \phi x_{t-1})^2 \right]$

Take derivative of objective function with respect to $\phi$:

Set derivative equal to zero and solve:

...
\end{document}